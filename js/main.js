document.addEventListener("DOMContentLoaded",()=>{let a,o,e=!1,l=e=>{var t=e=>Array.from(e).reduce((e,t)=>e+t.offsetWidth,0),e=(e&&(e=t(document.querySelector("#blog-info > a").children),t=t(document.getElementById("menus").children),a=e+t,o=document.getElementById("nav")),window.innerWidth<=768||a>o.offsetWidth-120);o.classList.toggle("hide-menu",e)},s={open:()=>{btf.overflowPaddingR.add(),btf.animateIn(document.getElementById("menu-mask"),"to_show 0.5s"),document.getElementById("sidebar-menus").classList.add("open"),e=!0},close:()=>{btf.overflowPaddingR.remove(),btf.animateOut(document.getElementById("menu-mask"),"to_hide 0.5s"),document.getElementById("sidebar-menus").classList.remove("open"),e=!1}},t=()=>{var v=GLOBAL_CONFIG.highlight;if(v){let{highlightCopy:e,highlightLang:h,highlightHeightLimit:p,highlightFullpage:t,highlightMacStyle:a,plugin:L}=v;v=GLOBAL_CONFIG_SITE.isHighlightShrink;let b=e||h||void 0!==v||t||a;var y="highlight.js"===L?document.querySelectorAll("figure.highlight"):document.querySelectorAll('pre[class*="language-"]');if((b||p)&&y.length){let i="prismjs"===L,o=!0===v?"closed":"",l=void 0!==v?'<i class="fas fa-angle-down expand"></i>':"",s=e?'<i class="fas fa-paste copy-button"></i>':"",r=t?'<i class="fa-solid fa-up-right-and-down-left-from-center fullpage-button"></i>':"",a=(a,n)=>{if(void 0!==GLOBAL_CONFIG.Snackbar)btf.snackbarShow(n);else{let e=document.createElement("div");e.className="copy-notice",e.textContent=n,document.body.appendChild(e);var n=a.getBoundingClientRect(),i=window.pageYOffset||document.documentElement.scrollTop,o=window.pageXOffset||document.documentElement.scrollLeft,i=n.top+i-40,o=n.left+o+n.width/2;let t=a.closest("figure.highlight").classList.contains("code-fullpage")?60+i:i;e.style.cssText=`
      top: ${10+t}px;
      left: ${o}px;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s ease, top 0.3s ease;
    `,requestAnimationFrame(()=>{e.style.opacity="1",e.style.top=t+"px"}),setTimeout(()=>{e.style.opacity="0",e.style.top=10+t+"px",setTimeout(()=>{e?.remove()},300)},800)}},n=async(e,t)=>{try{await navigator.clipboard.writeText(e),a(t,GLOBAL_CONFIG.copy.success)}catch(e){console.error("Failed to copy: ",e),a(t,GLOBAL_CONFIG.copy.noSupport)}},d=(e,t)=>{var e=e.parentNode,a=(e.classList.add("copy-true"),i?"pre code":"table .code pre"),a=e.querySelector(a);a&&(n(a.innerText,t),e.classList.remove("copy-true"))},c=e=>e.classList.toggle("closed"),g=(e,t)=>{e=e.closest("figure.highlight").classList.toggle("code-fullpage");document.body.style.overflow=e?"hidden":"",t.classList.toggle("fa-down-left-and-up-right-to-center",e),t.classList.toggle("fa-up-right-and-down-left-from-center",!e)},m=e=>{var t=e.target.classList,a=e.currentTarget;t.contains("expand")?c(a):t.contains("copy-button")?d(a,e.target):t.contains("fullpage-button")&&g(a,e.target)},u=e=>e.currentTarget.classList.toggle("expand-done"),f=(e,t)=>{var a,n=document.createDocumentFragment();b&&((a=document.createElement("div")).className="highlight-tools "+o,a.innerHTML='<div class="macStyle"><div class="mac-close"></div><div class="mac-minimize"></div><div class="mac-maximize"></div></div>'+l+e+s+r,btf.addEventListenerPjax(a,"click",m),n.appendChild(a)),p&&(t=>{let n=new Map;(()=>{let e=t;for(;e!==document.body&&null!=e;)"none"===window.getComputedStyle(e).display&&n.set(e,e.getAttribute("style")||""),e=e.parentNode;let a="visibility: hidden !important; display: block !important;";n.forEach((e,t)=>{t.setAttribute("style",e?e+";"+a:a)})})();var e=t.offsetHeight;return n.forEach((e,t)=>{""===e?t.removeAttribute("style"):t.setAttribute("style",e)}),e})(t)>p+30&&((e=document.createElement("div")).className="code-expand-btn",e.innerHTML='<i class="fas fa-angle-double-down"></i>',btf.addEventListenerPjax(e,"click",u),n.appendChild(e)),i?t.parentNode.insertBefore(n,t):t.insertBefore(n,t.firstChild)};y.forEach(e=>{let t="";i&&btf.wrap(e,"figure",{class:"highlight"}),h?(i?t=e.getAttribute("data-language")||"Code":"plain"!==(t=e.getAttribute("class").split(" ")[1])&&void 0!==t||(t="Code"),f(`<div class="code-lang">${t}</div>`,e)):f("",e)})}}},n=()=>{GLOBAL_CONFIG.isPhotoFigcaption&&document.querySelectorAll("#article-container img").forEach(e=>{var t,a=e.title||e.alt;a&&((t=document.createElement("div")).className="img-alt text-center",t.textContent=a,e.insertAdjacentElement("afterend",t))})},i=()=>{btf.loadLightbox(document.querySelectorAll("#article-container img:not(.no-lightbox)"))},r=async e=>{try{return await(await fetch(e)).json()}catch(e){return console.error("Failed to fetch URL:",e),[]}},d=(n,i,e)=>{let{isButton:o,limit:l,firstLimit:s,tabs:r}=e;e=i.length;let d=Math.ceil((e-s)/l+1);let c=new InfiniteGrid.JustifiedInfiniteGrid(n,{gap:5,isConstantSize:!0,sizeRange:[150,600],useTransform:!0,useRecycle:!1}),g=!1,m=e=>e&&e.replace(/"/g,"&quot;")||"",u=e=>{var t=e.alt?`alt="${m(e.alt)}"`:"",a=e.title?`title="${m(e.title)}"`:"";return`<div class="item">
        <img src="${e.url}" data-grid-maintained-target="true" ${t} ${a} />
      </div>`},f=(e,t,a=!1)=>{a=a?(e-1)*t:(e-2)*t+s;return i.slice(a,a+t).map(u)},h=(e,t,a)=>{c.append(f(e,t,a),e)},p=e=>{r&&(t=n.parentNode,g&&(t.style.visibility="visible"),0===n.offsetHeight)&&(t.style.visibility="hidden",g=!0);var{updated:t,isResize:e,mounted:a}=e;t.length&&a.length&&!e&&(btf.loadLightbox(n.querySelectorAll("img:not(.medium-zoom-image)")),c.getGroups().length===d?(btf.setLoading.remove(n),r||c.off("renderComplete",p)):o&&(btf.setLoading.remove(n),(e=>{let t=document.createElement("button");t.innerHTML=GLOBAL_CONFIG.infinitegrid.buttonText+'<i class="fa-solid fa-arrow-down"></i>',t.addEventListener("click",()=>{t.remove(),btf.setLoading.add(e),h(c.getGroups().length+1,l)},{once:!0}),e.insertAdjacentElement("afterend",t)})(n)))},t=btf.debounce(e=>{e=(+e.groupKey||0)+1;1===e?h(e,s,!0):h(e,l),e===d&&c.off("requestAppend",t)},300);btf.setLoading.add(n),c.on("renderComplete",p),o?h(1,s,!0):(c.on("requestAppend",t),c.renderItems()),btf.addGlobalFn("pjaxSendOnce",()=>c.destroy())},c=async(o,l=!1)=>{var e;o.length&&(e=async()=>{for(var e of o)if(!btf.isHidden(e)&&!e.classList.contains("loaded")){var t={isButton:"true"===e.getAttribute("data-button"),limit:parseInt(e.getAttribute("data-limit"),10),firstLimit:parseInt(e.getAttribute("data-first"),10),tabs:l},a=e.firstElementChild,n=a.textContent;a.textContent="",e.classList.add("loaded");try{var i="url"===e.getAttribute("data-type")?await r(n):JSON.parse(n);d(a,i,t)}catch(e){console.error("Gallery data parsing failed:",e)}}},"function"!=typeof InfiniteGrid&&await btf.getScript(GLOBAL_CONFIG.infinitegrid.js),await e())},g=e=>{var e=btf.getScrollPercent(e,document.body),t=document.getElementById("go-up");e<95?(t.classList.add("show-percent"),t.querySelector(".scroll-percent").textContent=e):t.classList.remove("show-percent")},m=()=>{let i=document.getElementById("rightside"),e=window.innerHeight+56,o=0,l=document.getElementById("page-header"),s="undefined"!=typeof chatBtn,r=GLOBAL_CONFIG.percent.rightside,d=()=>document.body.scrollHeight<=e&&(i.classList.add("rightside-show"),!0);if(!d()){let n="";var t=btf.throttle(()=>{var e,t=window.scrollY||document.documentElement.scrollTop,a=(e=(a=t)>o,o=a,e);56<t?(""===n&&(l.classList.add("nav-fixed"),i.classList.add("rightside-show")),a?"down"!==n&&(l.classList.remove("nav-visible"),s&&window.chatBtn.hide(),n="down"):"up"!==n&&(l.classList.add("nav-visible"),s&&window.chatBtn.show(),n="up")):(n="",0===t&&l.classList.remove("nav-fixed","nav-visible"),i.classList.remove("rightside-show")),r&&g(t),d()},300);btf.addEventListenerPjax(window,"scroll",t,{passive:!0})}},u=()=>{let g=GLOBAL_CONFIG_SITE.isToc,m=GLOBAL_CONFIG.isAnchor,a=document.getElementById("article-container");if(a&&(g||m)){let o,l,s,t,r;if(g){let a=document.getElementById("card-toc");l=a.querySelector(".toc-content"),o=l.querySelectorAll(".toc-link"),t=a.querySelector(".toc-percentage"),r=l.classList.contains("is-expand");btf.addEventListenerPjax(l,"click",e=>{var t=e.target.closest(".toc-link");t&&(e.preventDefault(),btf.scrollToDest(btf.getEleTop(document.getElementById(decodeURI(t.getAttribute("href")).replace("#",""))),300),window.innerWidth<900)&&a.classList.remove("open")}),s=e=>{var t=l.clientHeight,a=e.offsetTop,e=e.clientHeight,n=l.scrollTop,a=a-n,t=(t-e)/2;a!=t&&(l.scrollTop=n+(a-t))},l.style.display="block"}let d=a.querySelectorAll("h1,h2,h3,h4,h5,h6"),c="";var e=btf.throttle(()=>{var e=window.scrollY||document.documentElement.scrollTop;g&&GLOBAL_CONFIG.percent.toc&&(t.textContent=btf.getScrollPercent(e,a));{var n=e;if(0!==n){let t="",a="";for(let e=0;e<d.length;e++){var i=d[e];if(!(n>btf.getEleTop(i)-80))break;i=i.id;t=i?"#"+encodeURI(i):"",a=e}if(c!==a&&(m&&btf.updateAnchor(t),c=a,g)&&(l.querySelectorAll(".active").forEach(e=>e.classList.remove("active")),t)){let t=o[a];if(t.classList.add("active"),setTimeout(()=>s(t),0),!r){let e=t.parentNode;for(;!e.matches(".toc");)e.matches("li")&&e.classList.add("active"),e=e.parentNode}}}}},100);btf.addEventListenerPjax(window,"scroll",e,{passive:!0})}},f=a=>{let n=(window.globalFn||{}).themeChange||{};n&&Object.keys(n).forEach(e=>{let t=n[e];["disqus","disqusjs"].includes(e)?setTimeout(()=>t(a),300):t(a)})},h={readmode:()=>{let e=document.body,t=document.createElement("button"),a=()=>{e.classList.remove("read-mode"),t.remove(),t.removeEventListener("click",a)};e.classList.add("read-mode"),t.type="button",t.className="fas fa-sign-out-alt exit-readmode",t.addEventListener("click",a),e.appendChild(t)},darkmode:()=>{var e="dark"===document.documentElement.getAttribute("data-theme")?"light":"dark";"dark"==e?(btf.activateDarkMode(),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night)):(btf.activateLightMode(),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day)),btf.saveToLocal.set("theme",e,2),f(e)},"rightside-config":e=>{let t=e.firstElementChild;t.classList.contains("show")&&(t.classList.add("status"),setTimeout(()=>{t.classList.remove("status")},300)),t.classList.toggle("show")},"go-up":()=>{btf.scrollToDest(0,500)},"hide-aside-btn":()=>{var e=document.documentElement.classList,t=e.contains("hide-aside")?"show":"hide";btf.saveToLocal.set("aside-status",t,2),e.toggle("hide-aside")},"mobile-toc-button":(e,t)=>{let a=document.getElementById("card-toc");a.style.transition="transform 0.3s ease-in-out";var n=a.clientHeight,t=t.getBoundingClientRect(),i=window.innerHeight-t.bottom-30;i<n&&(a.style.transformOrigin=`right ${n-i-t.height/2}px`),a.classList.toggle("open"),a.addEventListener("transitionend",()=>{a.style.cssText=""},{once:!0})},"chat-btn":()=>{window.chatBtnFn()},translateLink:()=>{window.translateFn.translatePage()}},p=(document.getElementById("rightside").addEventListener("click",e=>{var t=e.target.closest("[id]");t&&h[t.id]&&h[t.id](e.currentTarget,t)}),()=>{var e=document.querySelectorAll("#article-container table");e.length&&e.forEach(e=>{e.closest(".highlight")||btf.wrap(e,"div",{class:"table-wrap"})})}),L=()=>{var e=document.querySelectorAll("#article-container .hide-button");e.length&&e.forEach(e=>e.addEventListener("click",e=>{e=e.currentTarget;e.classList.add("open"),c(e.nextElementSibling.querySelectorAll(".gallery-container"))},{once:!0}))},b=()=>{var e=document.querySelectorAll("#article-container .tabs");if(e.length){let i=(e,a)=>{e.forEach((e,t)=>{e.classList.toggle("active",t===a)})},a=e=>{var t,a,n=e.target.closest("button");n&&!n.classList.contains("active")&&(t=[...e.currentTarget.children],a=[...e.currentTarget.nextElementSibling.children],n=t.indexOf(n),i(t,n),e.currentTarget.classList.remove("no-default"),i(a,n),c(a[n].querySelectorAll(".gallery-container"),!0))};e.forEach(e=>{var t;btf.addEventListenerPjax(e.firstElementChild,"click",a),btf.addEventListenerPjax(e.lastElementChild,"click",(t=e,e=>{e.target.closest("button")&&btf.scrollToDest(btf.getEleTop(t),300)}))})}},v=e=>{e.forEach(e=>{e.textContent=btf.diffDate(e.getAttribute("datetime"),!0),e.style.display="inline"})};let y=()=>{t(),n(),c(document.querySelectorAll("#article-container .gallery-container")),i(),u(),p(),L(),b();let e=document.querySelectorAll("#article-container .aplayer");0<e.length&&window.addEventListener("load",()=>{e.forEach(e=>{e=e.aplayer;e&&e.on("play",()=>{var e=document.querySelector(".aplayer-fixed .aplayer");e&&e.aplayer&&e.aplayer.pause()})})})};var w=()=>{var e,t,a,n,i;l(!0),o.classList.add("show"),(i=document.getElementById("recent-posts"))&&i.classList.contains("masonry")&&(i=()=>{let e=new InfiniteGrid.MasonryInfiniteGrid(".recent-post-items",{gap:{horizontal:10,vertical:20},useTransform:!0,useResizeObserver:!0});e.renderItems(),btf.addGlobalFn("pjaxCompleteOnce",()=>{e.destroy()},"removeJustifiedIndexPostUI")},"function"==typeof InfiniteGrid?i():btf.getScript(""+GLOBAL_CONFIG.infinitegrid.js).then(i)),"post"===GLOBAL_CONFIG_SITE.pageType?((i=document.getElementById("post-outdate-notice"))&&({limitDay:n,messagePrev:e,messageNext:t,postUpdate:a}=JSON.parse(i.getAttribute("data")),n<=(n=btf.diffDate(a)))&&(i.textContent=e+` ${n} `+t,i.hidden=!1),GLOBAL_CONFIG.relativeDate.post&&v(document.querySelectorAll("#post-meta time"))):(GLOBAL_CONFIG.relativeDate.homepage&&v(document.querySelectorAll("#recent-posts time")),GLOBAL_CONFIG.runtime&&(a=document.getElementById("runtimeshow"))&&(e=a.getAttribute("data-publishDate"),a.textContent=btf.diffDate(e)+" "+GLOBAL_CONFIG.runtime),(n=document.getElementById("last-push-date"))&&(t=n.getAttribute("data-lastPushDate"),n.textContent=btf.diffDate(t,!0)),(i=document.querySelector("#aside-cat-list.expandBtn"))&&btf.addEventListenerPjax(i,"click",e=>{var t=e.target;"I"===t.nodeName&&(e.preventDefault(),t.parentNode.classList.toggle("expand"))},!0)),"home"===GLOBAL_CONFIG_SITE.pageType&&(i=document.getElementById("scroll-down"))&&btf.addEventListenerPjax(i,"click",()=>{btf.scrollToDest(document.getElementById("content-inner").offsetTop,300)}),m(),y(),"shuoshuo"!==GLOBAL_CONFIG_SITE.pageType&&btf.switchComments(document),(i=document.getElementById("toggle-menu"))&&btf.addEventListenerPjax(i,"click",()=>{s.open()})};btf.addGlobalFn("pjaxComplete",w,"refreshFn"),w(),window.addEventListener("resize",()=>{l(!1),e&&btf.isHidden(document.getElementById("toggle-menu"))&&s.close()}),(w=document.getElementById("menu-mask"))&&w.addEventListener("click",()=>{s.close()}),(w=document.querySelector("#sidebar-menus .menus_items"))&&w.addEventListener("click",e=>{e=e.target.closest(".site-page.group");e&&e.classList.toggle("hide")}),GLOBAL_CONFIG.islazyloadPlugin&&(window.lazyLoadInstance=new LazyLoad({elements_selector:"img",threshold:0,data_src:"lazy-src"}),btf.addGlobalFn("pjaxComplete",()=>{window.lazyLoadInstance.update()},"lazyload")),void 0!==GLOBAL_CONFIG.copyright&&(()=>{let{limitCount:n,languages:i}=GLOBAL_CONFIG.copyright;document.body.addEventListener("copy",e=>{e.preventDefault();var t=window.getSelection(0).toString();let a=t;return t.length>n&&(a=`${t}


${i.author}
${i.link}${window.location.href}
${i.source}
`+i.info),(e.clipboardData?e:window).clipboardData.setData("text",a)})})(),GLOBAL_CONFIG.autoDarkmode&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{void 0===btf.saveToLocal.get("theme")&&(e.matches?f("dark"):f("light"))}),window.addEventListener("hexo-blog-decrypt",e=>{y(),window.translateFn.translateInitialization(),Object.values(window.globalFn.encrypt).forEach(e=>{e()})})});